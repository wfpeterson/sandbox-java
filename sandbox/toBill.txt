19 Feb 2014 08:57:49,297  INFO [Thread-62] (PostDicomInstanceCommandImpl.java:347) - Previously supported SOP class (1.2.840.10008.5.1.4.1.1.77.1.5.1[OP]) detected. Delegating to 2005 processing command [TOPCON_SCU->60185/223].19 Feb 2014 08:57:49,297  INFO [Thread-62] (PostDicomInstanceCommandImpl.java:348) - gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl: Sending DICOM object 1.2.840.114257.0.112023120921608516800000830270000016849 to legacy DICOM Gateway for processing.19 Feb 2014 08:57:50,278 ERROR [Thread-62] (PostDicomInstanceTo2005CommandImpl.java:128) - Could not write to temporary DICOM file .19 Feb 2014 08:57:50,278 DEBUG [Thread-62] (DataSetByteReader.java:242) - writeFileToDisk: wait for producer thread to exit.19 Feb 2014 08:57:50,293 DEBUG [Thread-66] (DataSetByteReader.java:194) - Caught exception during run. Setting producerException for main thread to see:com.lbs.DCS.DCSException: writeDataSet failed:at com.lbs.DCS.DicomFileOutput.writeDataSet(DicomFileOutput.java:703)at gov.va.med.imaging.dicom.dcftoolkit.common.DataSetByteReader$1.run(DataSetByteReader.java:188)Caused by: com.lbs.DCS.IOWriteException: write failed:at com.lbs.DCS.DicomStreamWriter.write(DicomStreamWriter.java:103)at com.lbs.DCS.DicomExplicitLECodec.writeElementHeader(DicomExplicitLECodec.java:206)at com.lbs.DCS.DicomEncapsulatedCodec.writeElementHeader(DicomEncapsulatedCodec.java:701)at com.lbs.DCS.DicomTSCodec.writeElementHeader(DicomTSCodec.java:333)at com.lbs.DCS.DicomSQDelimElement.write(DicomSQDelimElement.java:176)at com.lbs.DCS.DicomSQElement.write(DicomSQElement.java:396)at com.lbs.DCS.DicomDeviceOutput.writeElement(DicomDeviceOutput.java:103)at com.lbs.DCS.DicomDeviceOutput.writeElement(DicomDeviceOutput.java:156)at com.lbs.DCS.DicomFileOutput.writeDataSet(DicomFileOutput.java:695)... 1 moreCaused by: java.io.IOException: Pipe closedat java.io.PipedInputStream.checkStateForReceive(Unknown Source)at java.io.PipedInputStream.receive(Unknown Source)at java.io.PipedOutputStream.write(Unknown Source)at java.nio.channels.Channels$WritableByteChannelImpl.write(Unknown Source)at com.lbs.DCS.DicomStreamWriter.write(DicomStreamWriter.java:97)... 9 more19 Feb 2014 08:57:50,293 DEBUG [Thread-62] (DataSetByteReader.java:244) - writeFileToDisk: join of producer thread complete.19 Feb 2014 08:57:50,293 DEBUG [Thread-62] (DataSetByteReader.java:249) - Rethrowing thread from producer thread on main thread:19 Feb 2014 08:57:50,293 ERROR [Thread-62] (PostDicomInstanceCommandImpl.java:231) - gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl :writeDataSet failed:com.lbs.DCS.DCSException: writeDataSet failed:at com.lbs.DCS.DicomFileOutput.writeDataSet(DicomFileOutput.java:703)at gov.va.med.imaging.dicom.dcftoolkit.common.DataSetByteReader$1.run(DataSetByteReader.java:188)Caused by: com.lbs.DCS.IOWriteException: write failed:at com.lbs.DCS.DicomStreamWriter.write(DicomStreamWriter.java:103)at com.lbs.DCS.DicomExplicitLECodec.writeElementHeader(DicomExplicitLECodec.java:206)at com.lbs.DCS.DicomEncapsulatedCodec.writeElementHeader(DicomEncapsulatedCodec.java:701)at com.lbs.DCS.DicomTSCodec.writeElementHeader(DicomTSCodec.java:333)at com.lbs.DCS.DicomSQDelimElement.write(DicomSQDelimElement.java:176)at com.lbs.DCS.DicomSQElement.write(DicomSQElement.java:396)at com.lbs.DCS.DicomDeviceOutput.writeElement(DicomDeviceOutput.java:103)at com.lbs.DCS.DicomDeviceOutput.writeElement(DicomDeviceOutput.java:156)at com.lbs.DCS.DicomFileOutput.writeDataSet(DicomFileOutput.java:695)... 1 moreCaused by: java.io.IOException: Pipe closedat java.io.PipedInputStream.checkStateForReceive(Unknown Source)at java.io.PipedInputStream.receive(Unknown Source)at java.io.PipedOutputStream.write(Unknown Source)at java.nio.channels.Channels$WritableByteChannelImpl.write(Unknown Source)at com.lbs.DCS.DicomStreamWriter.write(DicomStreamWriter.java:97)... 9 more19 Feb 2014 08:57:50,293 ERROR [Thread-62] (DicomStorageSCPImpl.java:248) - gov.va.med.imaging.core.interfaces.exceptions.MethodException: java.net.ConnectException: Connection refused: connectgov.va.med.imaging.core.interfaces.exceptions.MethodException: gov.va.med.imaging.core.interfaces.exceptions.MethodException: java.net.ConnectException: Connection refused: connectat gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceCommandImpl.java:214)at gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceCommandImpl.java:47)at gov.va.med.imaging.core.router.AbstractCommandImpl.callSynchronously(AbstractCommandImpl.java:508)at gov.va.med.imaging.core.RouterImpl.doSynchronously(RouterImpl.java:266)at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)at java.lang.reflect.Method.invoke(Unknown Source)at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:291)at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:180)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:147)at org.springframework.aop.framework.adapter.ThrowsAdviceInterceptor.invoke(ThrowsAdviceInterceptor.java:118)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:51)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:53)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:169)at $Proxy2.doSynchronously(Unknown Source)at gov.va.med.imaging.dicom.DicomRouterImpl.postDicomInstance(DicomRouterImpl.java:599)at gov.va.med.imaging.dicom.dcftoolkit.storagescp.impl.DicomStorageSCPImpl.receiveIOD(DicomStorageSCPImpl.java:146)at gov.va.med.imaging.dicom.dcftoolkit.listen.DicomDataService_a.storeObject(DicomDataService_a.java:402)at gov.va.med.imaging.dicom.dcftoolkit.listen.DicomDataService_a.storeObject(DicomDataService_a.java:877)at com.lbs.DSS.QRSCP.cStoreRq(QRSCP.java:277)at com.lbs.DCS.AssociationAcceptor.sendMessageToHandler(AssociationAcceptor.java:451)at com.lbs.DCS.AssociationAcceptor.processMessages(AssociationAcceptor.java:414)at com.lbs.DCS.AssociationAcceptor.handleAssociation(AssociationAcceptor.java:213)at com.lbs.DCS.AssociationManager.handleAssociation(AssociationManager.java:683)at com.lbs.DCS.AssociationManager.access$100(AssociationManager.java:72)at com.lbs.DCS.AssociationManager$2.run(AssociationManager.java:1241)at java.lang.Thread.run(Unknown Source)Caused by: gov.va.med.imaging.core.interfaces.exceptions.MethodException: java.net.ConnectException: Connection refused: connectat gov.va.med.imaging.core.router.commands.PostDicomInstanceTo2005CommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceTo2005CommandImpl.java:129)at gov.va.med.imaging.core.router.commands.PostDicomInstanceTo2005CommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceTo2005CommandImpl.java:38)at gov.va.med.imaging.core.router.AbstractCommandImpl.callSynchronously(AbstractCommandImpl.java:508)at gov.va.med.imaging.core.RouterImpl.doSynchronously(RouterImpl.java:266)at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)at java.lang.reflect.Method.invoke(Unknown Source)at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:291)at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:180)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:147)at org.springframework.aop.framework.adapter.ThrowsAdviceInterceptor.invoke(ThrowsAdviceInterceptor.java:118)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:51)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:53)at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:169)at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:169)at $Proxy2.doSynchronously(Unknown Source)at gov.va.med.imaging.dicom.router.facade.InternalDicomRouterImpl.postDicomInstanceTo2005(InternalDicomRouterImpl.java:292)at gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl.storeInstance(PostDicomInstanceCommandImpl.java:349)at gov.va.med.imaging.core.router.commands.PostDicomInstanceCommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceCommandImpl.java:178)... 29 moreCaused by: java.net.ConnectException: Connection refused: connectat java.net.PlainSocketImpl.socketConnect(Native Method)at java.net.PlainSocketImpl.doConnect(Unknown Source)at java.net.PlainSocketImpl.connectToAddress(Unknown Source)at java.net.PlainSocketImpl.connect(Unknown Source)at java.net.SocksSocketImpl.connect(Unknown Source)at java.net.Socket.connect(Unknown Source)at java.net.Socket.connect(Unknown Source)at java.net.Socket.<init>(Unknown Source)at java.net.Socket.<init>(Unknown Source)at gov.va.med.imaging.core.router.commands.PostDicomInstanceTo2005CommandImpl$GatewayTcpConnection.sendRequest(PostDicomInstanceTo2005CommandImpl.java:192)at gov.va.med.imaging.core.router.commands.PostDicomInstanceTo2005CommandImpl$GatewayTcpConnection.getTemporaryFilenameAndIEN(PostDicomInstanceTo2005CommandImpl.java:176)at gov.va.med.imaging.core.router.commands.PostDicomInstanceTo2005CommandImpl.callSynchronouslyInTransactionContext(PostDicomInstanceTo2005CommandImpl.java:90)... 49 more19 Feb 2014 08:57:50,293 ERROR [Thread-62] (DicomDataService_a.java:484) - gov.va.med.imaging.dicom.dcftoolkit.listen.DicomDataService_a: DICOM Storage SCP Exception thrown while storing object received from TOPCON_SCU/ [223]19 Feb 2014 08:57:50,293 ERROR [Thread-62] (DicomDataService_a.java:485) - Processing Error [TOPCON_SCU->60185/223]gov.va.med.imaging.core.interfaces.exceptions.MethodException: java.net.ConnectException: Connection refused: connect